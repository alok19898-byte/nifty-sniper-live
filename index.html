<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFTY SNIPER V9 - ULTRA GOLDEN</title>
    <style>
        :root { --bg: #050505; --gold: #ffd700; --red: #ff3333; --green: #00ff88; --gray: #1a1a1a; }
        body { background-color: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 5px; text-align: center; }

        /* DASHBOARD HEADER */
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; background: #111; padding: 15px; border-bottom: 3px solid var(--gold); margin-bottom: 20px; }
        .metric-box { background: #222; padding: 10px; border-radius: 8px; border: 1px solid #333; }
        .metric-title { font-size: 11px; color: #aaa; text-transform: uppercase; letter-spacing: 1px; }
        .metric-value { font-size: 24px; font-weight: 900; color: #fff; }
        
        /* PRESSURE BAR (Rule 1) */
        .pressure-container { grid-column: span 2; background: #222; padding: 10px; border-radius: 8px; }
        .progress-bar { height: 10px; background: #444; border-radius: 5px; overflow: hidden; margin-top: 5px; }
        .progress-fill { height: 100%; width: 0%; transition: width 0.5s ease; }
        .bull-fill { background: var(--green); }
        .bear-fill { background: var(--red); }

        /* MAIN TABLE */
        .table-container { overflow-x: auto; margin-bottom: 100px; }
        table { width: 100%; max-width: 1200px; margin: 0 auto; border-collapse: collapse; font-family: monospace; }
        th { background: #222; color: var(--gold); padding: 12px; font-size: 12px; border: 1px solid #333; }
        td { padding: 10px; border: 1px solid #1a1a1a; font-weight: bold; font-size: 14px; }

        /* THE DYNAMIC THICK RED LINE (Rule 2 Imaginary Line) */
        .imaginary-row { animation: pulse 1.5s infinite; }
        .imaginary-line { 
            background: var(--red); 
            color: white; 
            font-weight: 900; 
            font-size: 16px; 
            padding: 8px;
            border-top: 4px solid #fff; 
            border-bottom: 4px solid #fff; 
            text-align: center;
        }
        @keyframes pulse { 0% { opacity: 0.85; } 50% { opacity: 1; box-shadow: 0 0 15px var(--red); } 100% { opacity: 0.85; } }

        /* SIGNALS */
        .sig-box { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 900; display: inline-block; }
        .buy-sig { background: rgba(0,255,136,0.2); color: var(--green); border: 1px solid var(--green); }
        .sell-sig { background: rgba(255,51,51,0.2); color: var(--red); border: 1px solid var(--red); }
        .soc-sig { background: rgba(255,215,0,0.2); color: var(--gold); border: 1px solid var(--gold); }

        /* ALERTS (11k Rule) */
        .alert-overlay { position: fixed; top: 0; left: 0; width: 100%; background: #900; color: white; padding: 15px; font-weight: bold; z-index: 999; display: none; border-bottom: 4px solid white; animation: blink 0.5s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* FOOTER ENGINE */
        .engine-panel { position: fixed; bottom: 0; left: 0; width: 100%; background: #111; border-top: 4px solid var(--gold); padding: 10px; display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; box-shadow: 0 -5px 20px rgba(0,0,0,0.8); }
        .calc-val { font-size: 14px; color: #fff; margin: 0 10px; }
    </style>
</head>
<body>

    <div id="alertBox" class="alert-overlay">ðŸš¨ 11K RULE TRIGGERED: SCENARIO CHANGE DETECTED! EXIT NOW! ðŸš¨</div>

    <div class="dashboard">
        <div class="metric-box">
            <div class="metric-title">LIVE SPOT</div>
            <div id="spotPrice" class="metric-value" style="color:var(--gold);">25300.00</div>
        </div>
        <div class="metric-box">
            <div class="metric-title">MARKET STATE</div>
            <div id="marketState" class="metric-value" style="font-size:18px;">NORMAL</div>
        </div>
        <div class="metric-box">
            <div class="metric-title">SOC TIMER</div>
            <div id="socTimer" class="metric-value" style="font-size:18px; color:cyan;">00m</div>
        </div>
        
        <div class="pressure-container">
            <div class="metric-title" style="display:flex; justify-content:space-between;">
                <span>BEARISH PRESSURE</span>
                <span id="pressureText">BULLISH (85%)</span>
            </div>
            <div class="progress-bar">
                <div id="pressureBar" class="progress-fill bull-fill" style="width: 85%;"></div>
            </div>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>CE OI CHG</th>
                    <th>CE VOL</th>
                    <th>CE LTP</th>
                    <th>STRIKE</th>
                    <th>PE LTP</th>
                    <th>PE VOL</th>
                    <th>PE OI CHG</th>
                    <th>SNIPER SIGNAL</th>
                </tr>
            </thead>
            <tbody id="sniperTable"></tbody>
        </table>
    </div>

    <div class="engine-panel">
        <div class="calc-val"><b>R (Strike+LTP):</b> <span id="rVal" style="color:var(--red)">0</span></div>
        <div class="calc-val"><b>S (R-50):</b> <span id="sVal" style="color:var(--green)">0</span></div>
        <div class="calc-val buy-sig"><b>BULL (S+1):</b> <span id="bullVal">0</span></div>
        <div class="calc-val sell-sig"><b>BEAR (R-1):</b> <span id="bearVal">0</span></div>
    </div>

<script>
    // --- ULTRA GOLDEN ENGINE STATE ---
    let state = {
        spot: 25312.50,
        startTime: Date.now(),
        pressure: 75, // Starts at 75%
        direction: 1, // 1 for Bullish, -1 for Bearish
        stuckCounter: 0
    };

    function runSniperEngine() {
        // 1. Simulate Spot Movement (Random Fluctuation)
        let move = (Math.random() * 8) - 4; 
        state.spot += move;
        document.getElementById('spotPrice').innerText = state.spot.toFixed(2);

        // 2. Rule 6 Calculation (Resistance Based)
        let r_strike = Math.round(state.spot / 50) * 50;
        let ce_ltp = 24.50 + (Math.random() * 2);
        
        let R = r_strike + ce_ltp; 
        let R_1 = R - 50;  // Bearish Entry
        let S = R_1;       // Support
        let S_1 = S + 50;  // Bullish Entry (S+1)

        // Footer Update
        document.getElementById('rVal').innerText = R.toFixed(2);
        document.getElementById('sVal').innerText = S.toFixed(2);
        document.getElementById('bullVal').innerText = S_1.toFixed(2);
        document.getElementById('bearVal').innerText = R_1.toFixed(2);

        // 3. Pressure & Timer Logic (Rule 1 & 4)
        let elapsedMins = Math.floor((Date.now() - state.startTime) / 60000); // Minutes running
        document.getElementById('socTimer').innerText = elapsedMins + "m";

        // Logic: Pressure fluctuation between 75% and 100%
        state.pressure += (Math.random() * 4 - 2);
        if(state.pressure > 100) state.pressure = 100;
        if(state.pressure < 70) state.pressure = 70;
        
        let pText = state.pressure > 80 ? "BULLISH" : "NEUTRAL/BEARISH";
        let pColor = state.pressure > 80 ? "var(--green)" : "var(--red)";
        document.getElementById('pressureBar').style.width = state.pressure + "%";
        document.getElementById('pressureBar').style.background = pColor;
        document.getElementById('pressureText').innerText = `${pText} (${state.pressure.toFixed(1)}%)`;

        // Rule 2 & 4: Stuck / SOC
        if (elapsedMins > 180) {
            document.getElementById('marketState').innerText = "SOC (Rule 4)";
            document.getElementById('marketState').style.color = "gold";
        } else if (elapsedMins > 60) {
            document.getElementById('marketState').innerText = "STUCK (WTT/WTB)";
            document.getElementById('marketState').style.color = "orange";
        } else {
